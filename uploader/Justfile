# Justfile for uploader project

# Show help
help:
    just --list

# Run merge.sh in tmux session
merge:
    #!/bin/bash
    echo "Starting merge process in tmux..."
    tmux new-session -d -s merge-session './merge.sh'
    echo "Merge session started. Attach with: tmux attach -t merge-session"
    tmux list-sessions | grep merge-session

# Run upload.sh in tmux session with environment variables
upload remote_path:
    #!/bin/bash
    if [ ! -f ".env" ]; then
        echo "Error: .env file not found!"
        echo "Please create a .env file with:"
        echo "TELEGRAM_BOT_TOKEN=\"your_bot_token_here\""
        echo "TELEGRAM_CHAT_ID=\"your_chat_id_here\""
        exit 1
    fi
    echo "Starting upload process in tmux..."
    tmux new-session -d -s upload-session "source .env && ./upload.sh {{remote_path}}"
    echo "Upload session started with remote path: {{remote_path}}"
    echo "Attach with: tmux attach -t upload-session"
    tmux list-sessions | grep upload-session

# List active tmux sessions
sessions:
    tmux list-sessions

# Kill merge session
kill-merge:
    tmux kill-session -t merge-session || echo "No merge session found"

# Kill upload session  
kill-upload:
    tmux kill-session -t upload-session || echo "No upload session found"

# Kill all sessions
kill-all:
    tmux kill-session -t merge-session || true
    tmux kill-session -t upload-session || true
    echo "All sessions terminated"

